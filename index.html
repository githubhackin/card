<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Manhwa Card Maker HD</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>

<style>
/* =========================================================
   POPPINS EMBEBIDA - SIN DEPENDENCIAS EXTERNAS
========================================================= */

@font-face {
  font-family: 'PoppinsEmbed';
  src: url('https://fonts.gstatic.com/s/poppins/v20/pxiEyp8kv8JHgFVrJJfecnFHGPc.woff2') format('woff2');
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'PoppinsEmbed';
  src: url('https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLCz7Z1xlFd2JQEk.woff2') format('woff2');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: 'PoppinsEmbed';
  src: url('https://fonts.gstatic.com/s/poppins/v20/pxiByp8kv8JHgFVrLBT5Z1xlFd2JQEk.woff2') format('woff2');
  font-weight: 900;
  font-style: normal;
  font-display: swap;
}

body {
    font-family: 'PoppinsEmbed', system-ui, sans-serif;
    background: #020617;
    color: white;
}

/* ================= CARD ================= */
.capture-area {
    width: 400px;
    height: 600px;
    border-radius: 26px;
    overflow: hidden;
    position: relative;
    background: #0f172a;
}

#preview-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.card-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
        to top,
        rgba(0,0,0,1) 0%,
        rgba(0,0,0,.85) 35%,
        rgba(0,0,0,.4) 60%,
        transparent 100%
    );
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
}

.card-content {
    padding: 26px;
}

/* ================= GENRES (CENTRADO PERFECTO CON POPPINS) ================= */
.genre-container {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 12px;
}

.genre-pill {
    display: inline-block;
    background: #475569;
    color: white;
    font-family: 'PoppinsEmbed', system-ui, sans-serif;
    font-size: 13px;
    font-weight: 700;
    line-height: 1.3;
    padding: 6px 14px;
    border-radius: 8px;
    white-space: nowrap;
}

/* ================= TEXT ================= */
#card-title {
    font-family: 'PoppinsEmbed', system-ui, sans-serif;
    font-size: 30px;
    font-weight: 900;
    line-height: 1.1;
    margin-bottom: 8px;
}

#card-desc {
    font-family: 'PoppinsEmbed', system-ui, sans-serif;
    font-size: 13px;
    line-height: 1.55;
    color: #cbd5e1;
    max-height: 100px;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 5;
    -webkit-box-orient: vertical;
    text-align: justify;
}

/* ================= PANEL ================= */
.genre-toggle {
    background: #020617;
    border: 1px solid #334155;
    border-radius: 10px;
    padding: 6px 12px;
    font-weight: 700;
    cursor: pointer;
    font-size: 13px;
    transition: all .2s;
}

.genre-toggle.active {
    background: #0ea5e9;
    border-color: #38bdf8;
    color: white;
}

.genre-toggle:hover {
    border-color: #64748b;
}
</style>
</head>

<body class="p-6 flex justify-center">

<div class="grid lg:grid-cols-2 gap-10 max-w-6xl w-full">

<!-- PANEL -->
<div class="bg-slate-900/80 p-8 rounded-3xl border border-slate-700 h-fit shadow-2xl">
    <h2 class="text-2xl font-extrabold mb-6 text-cyan-400">Editor de Card</h2>

    <div class="space-y-4">
        <input id="in-title" placeholder="T√≠tulo del Manhwa"
        class="w-full bg-slate-950 border border-slate-700 p-3 rounded-xl outline-none focus:border-cyan-500">

        <textarea id="in-desc" rows="4" placeholder="Sinopsis..."
        class="w-full bg-slate-950 border border-slate-700 p-3 rounded-xl outline-none focus:border-cyan-500"></textarea>

        <p class="text-xs font-bold text-slate-500 uppercase tracking-widest">Selecciona G√©neros:</p>
<div class="flex flex-wrap gap-2">
    <div class="genre-toggle" data-genre="Acci√≥n">Acci√≥n</div>
    <div class="genre-toggle" data-genre="Aventura">Aventura</div>
    <div class="genre-toggle" data-genre="Fantas√≠a">Fantas√≠a</div>
    <div class="genre-toggle" data-genre="Magia">Magia</div>
    <div class="genre-toggle" data-genre="Supervivencia">Supervivencia</div>
    <div class="genre-toggle" data-genre="Vida Escolar">Vida Escolar</div>

    <div class="genre-toggle" data-genre="Romance">Romance</div>
    <div class="genre-toggle" data-genre="Drama">Drama</div>
    <div class="genre-toggle" data-genre="Comedia">Comedia</div>
    <div class="genre-toggle" data-genre="Tragedia">Tragedia</div>

    <div class="genre-toggle" data-genre="Reencarnaci√≥n">Reencarnaci√≥n</div>
    <div class="genre-toggle" data-genre="Isekai">Isekai</div>
    <div class="genre-toggle" data-genre="Regresi√≥n">Regresi√≥n</div>
    <div class="genre-toggle" data-genre="Viaje en el Tiempo">Viaje en el Tiempo</div>

    <div class="genre-toggle" data-genre="Cultivaci√≥n">Cultivaci√≥n</div>
    <div class="genre-toggle" data-genre="Artes Marciales">Artes Marciales</div>
    <div class="genre-toggle" data-genre="Sobrenatural">Sobrenatural</div>
    <div class="genre-toggle" data-genre="Psicol√≥gico">Psicol√≥gico</div>

    <div class="genre-toggle" data-genre="Horror">Horror</div>
    <div class="genre-toggle" data-genre="Misterio">Misterio</div>
    <div class="genre-toggle" data-genre="Suspenso">Suspenso</div>

    <div class="genre-toggle" data-genre="Sci-Fi">Ciencia Ficci√≥n</div>
    <div class="genre-toggle" data-genre="Apocal√≠ptico">Apocal√≠ptico</div>
    <div class="genre-toggle" data-genre="Post-Apocal√≠ptico">Post-Apocal√≠ptico</div>

    <div class="genre-toggle" data-genre="Harem">Harem</div>
    <div class="genre-toggle" data-genre="Reverse Harem">Reverse Harem</div>

    <div class="genre-toggle" data-genre="Militar">Militar</div>
    <div class="genre-toggle" data-genre="Crimen">Crimen</div>
    <div class="genre-toggle" data-genre="Deportes">Deportes</div>

    <div class="genre-toggle" data-genre="Gore">Gore</div>
    <div class="genre-toggle" data-genre="Adulto">Adulto</div>
</div>


        <div class="pt-4">
            <label class="block text-xs font-bold text-slate-500 uppercase mb-2">Imagen de Portada:</label>
            <input id="in-file" type="file" accept="image/*"
            class="block w-full text-sm text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:bg-slate-800 file:text-white hover:file:bg-slate-700 cursor-pointer">
        </div>

        <button onclick="saveCard()"
        class="w-full bg-cyan-600 hover:bg-cyan-500 py-4 rounded-xl font-bold transition-all shadow-lg mt-6 active:scale-95">
        ‚¨áÔ∏è Descargar Card Ultra HD (4K)
        </button>
    </div>
</div>

<!-- PREVIEW -->
<div class="flex flex-col items-center">
    <div id="capture-target" class="capture-area shadow-2xl">
        <img id="preview-img"
        src="https://via.placeholder.com/400x600/020617/475569?text=Carga+tu+Portada"
        alt="Preview">

        <div class="card-overlay">
            <div class="card-content">
                <div id="card-genres" class="genre-container"></div>
                <h2 id="card-title">T√≠tulo del Manhwa</h2>
                <p id="card-desc">Descripci√≥n del manhwa...</p>
            </div>
        </div>
    </div>
    <p class="text-slate-500 text-xs mt-4 font-bold uppercase tracking-widest">Vista Previa Real</p>
</div>

</div>

<script>
const $ = id => document.getElementById(id);
const genres = new Set();

$('in-title').oninput = e =>
    $('card-title').textContent = e.target.value || 'T√≠tulo del Manhwa';

$('in-desc').oninput = e =>
    $('card-desc').textContent = e.target.value || 'Descripci√≥n del manhwa...';

$('in-file').onchange = e => {
    const f = e.target.files[0];
    if (!f) return;
    const r = new FileReader();
    r.onload = ev => $('preview-img').src = ev.target.result;
    r.readAsDataURL(f);
};

document.querySelectorAll('.genre-toggle').forEach(btn => {
    btn.onclick = () => {
        const g = btn.dataset.genre;
        btn.classList.toggle('active');
        btn.classList.contains('active') ? genres.add(g) : genres.delete(g);

        $('card-genres').innerHTML =
            [...genres].map(g => `<div class="genre-pill">${g}</div>`).join('');
    };
});

/* ================= EXPORT ULTRA HD 4K ================= */
function saveCard() {
    const node = $('capture-target');
    const scale = 5; // üî• 5x = 2000x3000px (calidad profesional)

    // Mostrar indicador de carga
    const btn = event.target;
    const originalText = btn.innerHTML;
    btn.innerHTML = '‚è≥ Generando imagen HD...';
    btn.disabled = true;

    domtoimage.toPng(node, {
        quality: 1,
        width: 400 * scale,
        height: 600 * scale,
        style: {
            transform: `scale(${scale})`,
            transformOrigin: 'top left',
            width: '400px',
            height: '600px'
        }
    })
    .then(dataUrl => {
        const a = document.createElement('a');
        const filename = ($('in-title').value || 'manhwa').replace(/\s+/g, '_').toLowerCase();
        a.download = `card-${filename}-4k.png`;
        a.href = dataUrl;
        a.click();
        
        // Restaurar bot√≥n
        btn.innerHTML = '‚úÖ ¬°Descargado!';
        setTimeout(() => {
            btn.innerHTML = originalText;
            btn.disabled = false;
        }, 2000);
    })
    .catch(error => {
        console.error('Error:', error);
        btn.innerHTML = '‚ùå Error. Intenta de nuevo';
        setTimeout(() => {
            btn.innerHTML = originalText;
            btn.disabled = false;
        }, 2000);
    });
}
</script>

</body>
</html>
